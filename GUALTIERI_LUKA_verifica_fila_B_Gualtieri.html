<!DOCTYPE html>
<html lang="it">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <title>Verifica Gualtieri Luka Fila B</title>
</head>
<body>
<h3>Compagnia Noleggio Lukitoss.SRL</h3>
<p id="lista"> Lista Veicoli Noleggiati: </p>
<br>
<br>

    <!--bottone modale-->
    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#modalAggiungi">
        Aggiungi Veicolo
    </button>
    <!-- Modal -->
    <div class="modal fade" id="modalAggiungi" tabindex="-1" role="dialog" aria-labelledby="modalAggiungiLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
        <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="modalAggiungiLabel">Aggiungi Veicolo</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body">
            <form>
                <div class="form-group">
                    <label for="Tipo">Tipo</label>
                    <input type="text" class="form-control" id="Tipo" aria-describedby="Tipo">
                </div>
                <div class="form-group">
                    <label for="Marca">Marca</label>
                    <input type="text" class="form-control" id="Marca" aria-describedby="Marca">
                </div>
                <div class="form-group">
                    <label for="Modello">Modello</label>
                    <input type="text" class="form-control" id="Modello" aria-describedby="Modello">
                </div>
                <div class="form-group">
                    <label for="Anno">Anno</label>
                    <input type="number" class="form-control" id="Anno" aria-describedby="Anno">
                </div>
                <div class="form-group">
                    <label for="PrezzoOra">Prezzo Noleggio Orario</label>
                    <input type="number" class="form-control" id="PrezzoOra" aria-describedby="PrezzoOra">
                </div>
        </div>

        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Chiudi</button>
            <button type="button" class="btn btn-primary" onclick="aggiungiVeicolo()" data-dismiss="modal">Aggiungi</button>
        </div>
        </div>
        </div>
    </div>
    <!--end modal-->

    <!--bottone modale-->
    <button type="button" onclick="modificaTabella()" class="btn btn-primary" data-toggle="modal" data-target="#modalTable">
        Elenco Noleggi
    </button>
    <!-- Modal -->
    <div class="modal fade" id="modalTable" tabindex="-1" role="dialog" aria-labelledby="modalTableLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
        <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="modalTableLabel">Elenco Noleggi</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body">
            <!--tabella veicoli noleggiati-->
            <table class="table">
                <thead>
                <tr>
                    <th scope="col">Tipo</th>
                    <th scope="col">Marca</th>
                    <th scope="col">Modello</th>
                    <th scope="col">Anno</th>
                    <th scope="col">Prezzo Orario</th>
                </tr>
                </thead>
                <tbody id="outputVeicoli">
                </tbody>
            </table>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Chiudi</button>
        </div>
        </div>
        </div>
    </div>
    <!--end modal-->

    <br><br>

    <!--bottone modale-->
    <button type="button" onclick="" class="btn btn-primary" data-toggle="modal" data-target="#modalRestituzioni">
        Restituzione Veicolo
    </button>
    <!-- Modal -->
    <div class="modal fade" id="modalRestituzioni" tabindex="-1" role="dialog" aria-labelledby="modalRestituzioniLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
        <div class="modal-content">
        <div class="modal-header">
            <h5 class="modal-title" id="modalRestituzioniLabel">Restituzione Veicolo</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body">
            <form>
                <div>
                    <label for="Clienti">Clienti</label>
                    <select class="form-control" id="clientiRestituzione" onclick="">
                    </select>
                </div>
                <div>
                    <label for="AutoNoleggiate">Auto Noleggiate</label>
                    <select class="form-control" id="noleggiate">
                    </select>
                </div>
            </form>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Chiudi</button>
            <button type="button" class="btn btn-primary" onclick="restituisciVeicolo()" data-dismiss="modal">Restituisci</button>
        </div>
        </div>
        </div>
    </div>
    <!--end modal-->

        <!--bottone modale-->
        <button type="button" onclick="" class="btn btn-primary" data-toggle="modal" data-target="#modalNoleggio">
            Noleggio Veicolo
        </button>
        <!-- Modal -->
        <div class="modal fade" id="modalNoleggio" tabindex="-1" role="dialog" aria-labelledby="modalNoleggioLabel" aria-hidden="true">
            <div class="modal-dialog" role="document">
            <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalNoleggioLabel">Restituzione Veicolo</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form>
                    <div>
                        <label for="Clienti">Clienti</label>
                        <select class="form-control" id="clientiNoleggia">
                        </select>
                    </div>
                    <div>
                        <label for="AutoDisponibili">Auto Disponibili</label>
                        <select class="form-control" id="disponibili">
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Chiudi</button>
                <button type="button" class="btn btn-primary" onclick="noleggiaVeicolo()" data-dismiss="modal">Restituisci</button>
            </div>
            </div>
            </div>
        </div>
        <!--end modal-->

<script>
    class Veicolo{
        constructor(tipo, marca, modello, anno, prezzoNoleggioOrario){
            this.tipo=tipo;
            this.marca=marca;
            this.modello=modello;
            this.anno=anno;
            this.prezzoNoleggioOrario=prezzoNoleggioOrario;   
        }

        calcolaCostoNoleggio(ore){
          return ore*this.prezzoNoleggioOrario; 
        }
    }

    class Cliente{
        constructor(nome, cognome, numPatente, veicoliNoleggiatiCliente){
            this.nome=nome;
            this.cognome=cognome;
            this.numPatente=numPatente;
            this.veicoliNoleggiatiCliente=[];    
        }

        noleggiaVeicolo(veicolo){
            this.noleggiEffettuati.push(veicolo);
        }

        restituisciVeicolo(veicolo){
            if(this.noleggiEffettuati.length > 0)
                this.noleggiEffettuati.pop(veicolo); 
        }
    }

    class CompagniaNoleggio{
        constructor(){
            this.inventario=[];
            this.clienti=[]
            this.veicoliNoleggiati=[];    
        }

        aggiungiVeicolo(veicolo){
            this.inventario.push(veicolo);
        }

        registraCliente(cliente){
            this.clienti.push(cliente);
        }

        effettuaNoleggio(cliente, veicolo){
            this.noleggi.push(veicolo);
            this.inventario.pop(veicolo);
            cliente.noleggiaVeicolo(veicolo);
        }

        restituisciVeicolo(cliente, veicolo){
            this.noleggi.pop(veicolo);
            this.inventario.push(veicolo);
            cliente.restituisciVeicolo(veicolo);
        }

        elencoVeicoliNoleggiati(cliente){
            return cliente.veicoliNoleggiatiCliente;
        }
        }
    

        //Creazione compagnia 
        let compagniaNoleggio = new CompagniaNoleggio();

        //Creazione Veicolo 
        var veicolo1 = new Veicolo('auto', 'Ferrari', 'F8', '2023', 40);
        var veicolo2 = new Veicolo('moto', 'Tm', 'Smr 125', '2024', 20);
        var veicolo3 = new Veicolo('auto', 'Lamborghini', 'Huracan', '2023', 50);
        var veicolo4 = new Veicolo('auto', 'Ktm', 'Sx 125', '2024', 25);
        var veicolo5 = new Veicolo("mini","Fiat","500",2015,130);
        var veicolo6 = new Veicolo("4x4","Panda","L83",1990,50);
        var veicolo7 = new Veicolo("quadriciclo","Lamborghini","RS1",2023,550);

        //Aggiunta Veicolo 
        compagniaNoleggio.aggiungiVeicolo(veicolo1);
        compagniaNoleggio.aggiungiVeicolo(veicolo2);
        compagniaNoleggio.aggiungiVeicolo(veicolo3);
        compagniaNoleggio.aggiungiVeicolo(veicolo4);
        compagniaNoleggio.aggiungiVeicolo(veicolo5);
        compagniaNoleggio.aggiungiVeicolo(veicolo6);
        compagniaNoleggio.aggiungiVeicolo(veicolo7);

        //Creazione Cliente 
        var cliente1 = new Cliente('Luka', 'Gualtieri', 123456, 2);
        var cliente2 = new Cliente('Matteo', 'Ranzani', 654321, 1);
        var cliente3 = new Cliente("Valentina","Marinelli","SS6743",7);
        var cliente4 = new Cliente("Tommaso","Fagnani","GE8902",9);

        //Aggiunta Cliente 
        compagniaNoleggio.registraCliente(cliente1);
        compagniaNoleggio.registraCliente(cliente2);
        compagniaNoleggio.registraCliente(cliente3);
        compagniaNoleggio.registraCliente(cliente4);

        //Registro un Noleggio
        compagniaNoleggio.effettuaNoleggio(cliente1, veicolo3);
        compagniaNoleggio.effettuaNoleggio(cliente2, veicolo1);
        compagniaNoleggio.effettuaNoleggio(cliente3, veicolo4);

        //Registro una Restituzione
        console.log("Veicolo restituito e rimosso dai noleggiati: ")
        compagniaNoleggio.restituisciVeicolo(cliente2, veicolo1);

        console.log("Veicoli noleggiati da un cliente: ")
        compagniaNoleggio.elencoVeicoliNoleggiati(cliente3);

        console.log("Lista dei veicoli noleggiati: ")
        console.log(compagniaNoleggio.veicoliNoleggiati)

        let lista = compagniaNoleggio.veicoliNoleggiati;
        document.getElementById("lista").innerHTML+="<li>"+lista.veicolo+"</li>";


        //INTERFACCIA
        let stringa = "";
        for(let i=0; i<compagniaNoleggio.clienti.length;i++){
            stringa += `<option value=${i}>${compagniaNoleggio.clienti[i].nome}</option>`;
        }
        document.getElementById("clientiRestituzione").innerHTML=stringa;
        document.getElementById("clientiNoleggia").innerHTML=stringa;

        function modificaTabella(){
            let tbody=document.getElementById("outputVeicoli");
            let stringa = "";
            compagniaNoleggio.veicoliNoleggiati.forEach(veicolo => {
                stringa += `<tr><td>${veicolo.tipo}</td>`;
                stringa += `<td>${veicolo.marca}</td>`;
                stringa += `<td>${veicolo.modello}</td>`;
                stringa += `<td>${veicolo.anno}</td>`;
                stringa += `<td>${veicolo.prezzoNoleggioOrario}</td></tr>`;
            });
            tbody.innerHTML=stringa;
        }

        function aggiungiVeicolo() {
            let tipo = document.getElementById("Tipo").value;
            let marca = document.getElementById("Marca").value;
            let modello = document.getElementById("Modello").value;
            let anno = document.getElementById("Anno").value;
            let prezzoOra = document.getElementById("PrezzoOra").value;

            let veicoloAggiunto = new Veicolo(tipo, marca, modello, anno, prezzoOra);
            compagniaNoleggio.aggiungiVeicolo(veicoloAggiunto);
        
        }

        function restituisciVeicolo(){
            let cliente = compagniaNoleggio.clienti[document.getElementById("clientiRestituzione").value];
            let autoRestituita = cliente.veicoliNoleggiatiCliente[document.getElementById("noleggiate").value];
            compagniaNoleggio.restituisciVeicolo(cliente, autoRestituita)
        }

        function noleggiaVeicolo(){
            let cliente = compagniaNoleggio.clienti[document.getElementById("clientiRestituzione").value];
            let autonoleggiata = cliente.veicoliNoleggiatiCliente[document.getElementById("noleggiate").value];
            compagniaNoleggio.effettuaNoleggio(cliente, autonoleggiata);
        }
    </script>

    <!-- Optional JavaScript; choose one of the two! -->

    <!-- Option 1: jQuery and Bootstrap Bundle (includes Popper) 
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
    -->

    <!-- Option 2: jQuery, Popper.js, and Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>
  </body>
</html>
